### Running inference on proteins:

# retain AA data -- should test mask vs unmask on diversity
python eval.py --n_gens 3 --load_dir PDB_test_AA --retain_AA --mask_prior

# CG only (much faster)
python eval.py --n_gens 3 --load_dir PDB_test_CG --mask_prior

# Inference on complete 24-protein test set (try with and without mask prior)
python eval.py --n_gens 5 --load_dir PDB --mask_prior --CG_noise 0.001

# Slow inference (same as above but retains all positions and checks metrics)
python eval.py --n_gens 5 --load_dir PDB --retain_AA --check_bonds --check_clash --check_div  --mask_prior

# Inference on DES -- test timing with no stride (2000 frame )
python eval.py --n_gens 5 --load_dir DES --retain_AA --check_bonds --check_clash --check_div  --mask_prior

# Inference on CA-only trajectory (this includes preprocessing step to expand AA pdb with a stride)
python eval.py --n_gens 3 --load_dir CG-pro_raw --mask_prior --stride 10


#### Running inference on DNA-protein: ####

- Various command in ./figures/DNA-protein_from-eval
- Test set contains 55 structures including those from 

# navigate to inference script directory
cd ./scripts

# run eval 
# --n_gens number of generated samples to create
# --check_div calculate diversity
# --check_bond calculates bond score
# --ckp specified model checkpoint
# --mask_prior ensures CG coordinates are maintained consistently
# --load_dir where to look for test data
# --save_dir where to save (model information is appended as well)
# --system provides information about modle

python eval_dna.py --n_gens 5 --check_div --check_bond --model_path ../jobs/time-batch_adamW_dna-clean-no-rev-mis-0_120-500_mmseqs-reidx-valid-fix_L1_m-32_clamp-2.0_attn-0_dim-32_nn-15_depth-6_eps-2001_sigma-0.005_batch-1_CG-noise-0.003_lr-0.001_wdecay-0.0_CGadj--1.0_pos-1_bpack-max_lrdecay-0.0_diff-xt_seed-13 --ckp 600 --mask_prior --load_dir ../sidechainnet_data/DNAPro_seed-13_test --save_dir ../sidechainnet_scores/DNAPro_seed-13_test --system dna-clean-fix-mis-0_120-500

## new run command, uses sig=0.006 by default ##
python eval_dna.py --n_gens 5 --ckp 750 --mask_prior --load_dir DNAPro_test

## for genesis PWMcos ##
python eval_dna.py --n_gens 3 --ckp 750 --mask_prior --load_dir PWMcos

## Env setup instruction
git clone
conda create -n flowback python=3.9
conda activate flowback 
pip install egnn_pytorch   # automatically installs torch-2.3 + cu12-12 which may not work
pip install -c conda-forge openmm sidechainnet
conda install mdtraj matplotlib pandas # running now 
conda install conda-forge::tqdm

## test with the following
cd ./scripts
python eval.py --n_gens 3 --load_dir PDB_test_CG --mask_prior


# TODO
- include best models in 'models_final' folder and set as default for protein or protein-DNA
- make the trajectory pre-processing (optionally) part of inference
- make sure outputs (number of 

